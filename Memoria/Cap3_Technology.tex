% ---------------------------------------------------
%
% Trabajo de Fin de Grado. 
% Author: Laura Padrón Jorge. 
% Capítulo: Tecnologías utilizadas en el Trabajo de Fin de Grado. 
% Fichero: Cap3_Technology.tex
%
% ----------------------------------------------------
%

\cleardoublepage
\chapter{Tecnologías} \label{chap:Tecnologias} 

En este capítulo se habla de las principales tecnologías que han sido utilizadas durante la elaboración de este TFG.


\section{El Sistema Operativo Android}

Con frecuencia anteriormente en el desarrollo de este documento hemos nombrado el Sistema Operativo (S.O) Android, pero ¿Qué es Android?

Android es un sistema operativo que emplea Linux en la interfaz del hardware.  Los componentes del SO subyacentes se escriben en C o C++ pero las aplicaciones diseñadas se escriben en Java. De esta manera Android asegura una amplia operatividad en una gran variedad de dispositivos debido a dos hechos: la interfaz en Linux ofrece gran potencia y funcionalidad para aprovechar el hardware de los futuros dispositivos, mientras que el hecho de que las aplicaciones se desarrollen en Java permite que Android sea accesible para un gran número de programadores conocedores del código.

Fue diseñado principalmente para dispositivos móviles con pantalla táctil, smartphones, tablets y otros dispositivos como televisores o automóviles. Inicialmente fue desarrollado por Android Inc., empresa que fue respaldada económicamente por Google y más tarde fue comprada por esta misma empresa.

Tiene una gran comunidad de desarrolladores creando aplicaciones para extender la funcionalidad de los dispositivos. A la fecha existen más de 1.000.000 de aplicaiones disponibles para la tienda de aplicaciones oficial de Android: Google Play \cite{URL::GooglePlay} sin tener en cuenta las aplicaciones de otras tiendas no oficiales para Android como la tienda de aplicaciones de Samsung Apps \cite{URL::SamsungApps}, Slideme…

\section{Los llamados Beacons}

Los \textit{''Beacons''} \cite{URL::Beacon}, cuya traducción del inglés equivaldría a \textit{''balizas''} o \textit{''faros''}, es una tecnología emergente que desde algunos años se está intentando abrir paso en el mercado. Como su propio nombre indica, estos dispositivos intentan dar una mejor solución al posicionamiento en interiores, siendo un mecanismo de guía en lugares donde otras tecnologías, como el GPS o el Wifi dejan de funcionar o resultan imprecisas. 

Sin embargo, estos no son los únicos usos de los beacons, actualmente muchas empresas están ampliando sus usos a otros campos, y el diseño de estos beacons se está presentando en tamaños tan pequeños y con un tiempo de funcionamiento tan elevado, que se pueden desplegar prácticamente en cualquier lugar sin dificultades.

A continuación se intentará responder a las preguntas más frecuentes que nos pueden surgir con respecto a esta tecnología:


\begin{itemize}
\item ¿Qué es un Beacon?
\item ¿Cómo funcionan estos dispositivos?
\item ¿Qué rango de alcance poseen?
\item ¿Con qué dispositivos móviles son compatibles? 
\item ¿Qué ventajas y desventajas tienen con respecto a otras tecnologías?
\item ¿Qué usos se le ha dado a esta tecnología hasta ahora?
\item ¿Qué empresas trabajan con esta tecnología?
\end{itemize}

\begin{figure}[!h]
        \begin{floatrow}
        \ffigbox{\includegraphics[width=\textwidth/2]{estimoteBeacon}}{\caption{Uno de los beacons de la compañia Estimote}\label{fig:estimote_Beacon}}
        \ffigbox{\includegraphics[width=\textwidth/2]{estimoteSticker}}{\caption{Uno de los beacons de la compañia Estimote en formato Pegatina}\label{fig:estimote_Beacon_Sticker}}
        \end{floatrow}
\end{figure}

\subsection{¿Qué es un Beacon?}

Para los que no hayan oido este término, en el marco en el que nos movemos, hace referencia a un pequeño dispositivo (sus tamaños varían de uno a otro, pero siempre de tamaño reducido) que emite señales de onda corta utilizando la tecnología Bluetooth \cite{URL::Bluetooth}. Estas señales contienen una pequeña cantidad de información y son recibidas por dispositivos móviles con tecnología Bluetooth dentro de un rango de cobertura variable dependiendo del propio dipositivo. Normalmente, la fuerza de esta señal y su frecuencia son configurables.

\begin{figure}[h]
	\centering
	\includegraphics[width=\columnwidth]{beaconPhone}
	\caption{Representación de un beacon emitiendo mediante Bluetooth a un dispositivo móvil}
	\label{fig:beaconBluetooth}
\end{figure}

El funcionamiento de un beacon es sencillo: El beacon emite una señal ininterrumpida que es captada por los dispositivos móviles dentro de su radio de cobertura, esta señal contiene información capaz de definir una localización, detectar y localizar otros dispositivos. A continuación la señal es captada por una aplicación movil previamente instalada, que dependiendo de la señal recibida, puede lanzar una acción en dicho dispositivo.


Hay que tener en cuenta que esta señal es unilateral: los beacons son capaces de enviar señales pero no están preparados para recibirlas. También hay que tener en cuenta, que la mayoría de las beacon actuales en el mercado transmiten información preconfigurada, confiando en la aplicacion móvil para utilizar la información; sin embargo es muy posible que esto cambie en un futuro, ampliando las posibilidades de los beacons.

\subsection{¿Como funcionan estos dispositivos?}

Los beacons usan Bluetooth Low Energy (BLE) \cite{URL::BluetoothLowEnergy}, una version del protocolo Bluetooth diseñada para usar mucha menos energía y enviar menos información. Los beacons funcionan con baterías cuyo tiempo de vida depende de la configuración establecida, teniendo en cuenta la emisión de la señal (fuerza y frencuencia) y tiempo de hibernación. Sus tiempos de vida son variables, pudiendo durar desde un mes hasta varios años. 

\begin{figure}[h]
	\centering
	\includegraphics[width=\columnwidth]{estimoteBeaconInside}
	\caption{Interior de un beacon de Estimote}
	\label{fig:beaconInside}
\end{figure}

Independientemente de lo que se pueda pensar, los beacons en si mismas no transmiten información significativa, transmiten identificadores cortos junto con información customizable breve, que son interpretadas por una aplicación que sabe lo que tiene que hacer con esa información y que es la que se encarga de procesar la información y realizar una acción pertinente.

Este identificador se divide en tres partes: 

\begin{itemize}
\item \textit{''UUID''} \cite{URL::UUID} : corresponde con una ID dada por el vendedor e identifica el beacon en cuestión.
\item ID Superior : customizables y utilizadas con un significado específico que puede identificar una acción o parámetro. 
\item ID Inferior: customizables y utilizadas al igual que la superior con un significado específico que se puede usar para identificar una acción o parámetro.
\end{itemize}

\begin{figure}[h]
	\centering
	\includegraphics[width=\columnwidth]{identity}
	\caption{Numeros identificativos de los beacons}
	\label{fig:beaconId}
\end{figure}

\subsection{¿Qué rango de alcance poseen?}

Actualmente los beacons presentan un rango de aproximadamente 70 metros sin obstáculos, esta demostrado que este rango disminuye significativamente al atravesar paredes de metal o ladrillo, otros materiales disminuyen en menor medida el rango. 

Los beacons además trabajan con tres rangos de distancia principalmente: 

\begin{itemize}
\item Lejos: diseñado para que el dispositivo móvil pueda lanzar una acción cuando estás en el rango exterior de un beacon, acabas de entrar en el rango del beacon.
\item Cerca: diseñado para que el dispositivo móvil pueda lanzar una acción cuando estás en el rango interior del beacon. 
\item Inmediato: Diseñado para que el dispositivo móvil pueda lanzar una acción cuando te encuentres manejando el beacon, la posición del beacon cambia.
\end{itemize}

\begin{figure}[h]
	\centering
	\includegraphics[width=\columnwidth]{BeaconsRange}
	\caption{Ejemplificación del rango de un beacon}
	\label{fig:beaconRange}
\end{figure}

\subsection{¿Con qué dispositivos funcionan?}

Las beacons son compatibles con todos los dispositivos que soporten Bluetooth Low Energy, pero para que las señales de los beacons sean detectadas por tu dispositivo, se ha de tener activado el Bluetooth. 


En dispositivos con IOS7 \cite{URL::IOS7} o superior, el dispositivo puede estar constantemente buscando dispositivos BLE y despertar a las aplicaciones implicadas cuando entran en el rango de los beacons, incluso estando cerradas las aplicaciones.


En dispositivos Android \cite{URL::Android} el sistema operativo no está preparado para escanear dispositivos BLE, por lo que son las aplicaciones las que se tienen que encargar de escanear las proximidades buscando beacons, esto supone que las aplicaciones tienen que estar funcionando, despiertas (aunque sea en segundo plano).

Por último en dispositivos Windows Phone \cite{URL:WindowsPhone} o Blackberry \cite{URL:Blackberry} existen diferentes niveles de compatibilidad pero en los que soportan BLE, en funcionamiento es similar al de los dispositivos Android. 

\subsection{¿Qué ventajas y desventajas tienen con respecto a otras tecnologías?}

A la hora de hablar de los beacons existen una serie de ventajas pero también podemos encontrar algunas desventajas que iremos detallando a continuación. 


Las principales ventajas que se distinguen a la hora de hablar de las beacons son las siguientes: 

\begin{itemize}
\item A diferencia de la tecnología GPS, la activación del bluetooth consume mucho menos batería. 
\item Es una tecnología que puede ser dependiente de la red de datos. 
\item A diferencia de la tecnología GPS, sigue funcionando con gran precisión en el interior de los edificios.
\end{itemize}

En cuanto a las desventajes que nos podemos encontrar destacamos:

\begin{itemize}
\item Dependen de aplicaciones instaladas en el dispositivo móvil para funcionar. 
\item Es necesario tener el bluetooth activado, lo que consume batería en el tiempo. 
\item Su utilidad depdende de la voluntad de terceros de utilizar estos dispositivos, configurarlos y distribuir las aplicaciones.
\end{itemize}

\subsection{¿Qué usos se le ha dado a esta tecnología hasta ahora?}

Por ahora esta tecnología se ha utilizado en ambiente muy diversos y con distintas funcionalidades. De los más conocidos podríamos destacar los siguientes: 

\vspace{5mm}

\textsl{\textbf{{Clevedon School (K-12)}}}

\vspace{2mm}

Este ejemplo es bastante significativo ya que se aplicó en el mismo entorno en el que queremos trabajar, una institución de enseñanza universitaria. Después de desplegar cerca de 1200 iPads  la universidad de Clevedon utilizó esta tecnología junto con su aplicación universitaria ya existente. 

\begin{figure}[H]
	\centering
	\includegraphics[width=\columnwidth]{ClevedonApp}
	\caption{La aplicación de Clevedon School}
	\label{fig:beaconRange}
\end{figure}


Han sido capaces de crear una manera fácil para que los profesores puedan añadir recursos que se envian automáticamente a los alumnos transitando diferentes zonas en diferentes horarios.Para realizar este trabajo de manera eficiente fue necesario la creación de una Interface para la gestión de los recursos en las diferentes Beacons.


Esta interfaz junto con la aplicación móvil es capaz de: 

\begin{itemize}
\item Programar los recursos para distribuirse a una hora del día especificada. 
\item Programar el material para ser distribuido en un momento determinado durante una clase o evento. 
\item Poner los recursos a disposición de los alumos que se encuentren en una localización específica.
\end{itemize}

Utilizando estos tres recursos, la aplicación, la interfaz y los beacons han sido capaces de crear un entorno interactivo y eficiente motivando tanto a profesores como estudiantes. 

\vspace{5mm}

\textsl{\textbf{{Cleveland Cavaliers Stadium y Levi's Stadium}}}

\vspace{2mm}

Dos de los ejemplos más conocidos han sido los despliegues que se han realizado en estos dos estadios. 

\begin{figure}[H]
	\centering
	\includegraphics[width=\columnwidth]{LevisStadium}
	\caption{La aplicación de Levi's Stadium}
	\label{fig:levisStadium}
\end{figure}

Por un lado tenemos el despliegue del estadio de Levi's , cuya intención ha sido la de ayudar a sus fans a navegar por el estadio dadas sus dimensiones.En este caso los beacons (de la comañía Aruba Networks) se utilizan en conjunto con puntos de acceso y repetidores situados por toda la infraestructura de manera que queda el estadio cubierto. Con la aplicación los fans también son capaces de ver repeticiones de las jugadas y pedir comida directamente desde sus dispositivos móviles.


Un punto importante de este  despliegue ha sido la monitorización continua del funcionamiento de los beacons, incluyendo si estan en funcionamiento o necesitan bateria nueva. Los beacons son también más económicos que los puntos de acceso WiFi, lo cual les ha beneficiado.

En el caso del estadio de Cleveland, los beacons se encargan de proveer al usuario de información personalizada dependiendo del lugar y la hora. En algunos casos videos, ofertas promocionales y contenido adicional.

\vspace{5mm}

\textsl{\textbf{{Orlando Int'l Airport}}}

\vspace{2mm}

Otro despliegue exitoso de esta tecnología ha sido en el Aeropuerto Internacional de Orlando , donde mediante el uso de los beacons y de una aplicación móvil propia han sido capaces de proporcionar una serie de funcionalidades de vital importancia en una infraestructura como el aeropuerto: 

\begin{itemize}
\item Navegación paso por paso a través de cerca de 1000 establecimientos o servicios dentro del aeropuerto. 
\item Actualizaciones inmediatas de la información de los vuelos. 
\item Intrucciones a puntos de interés criticos como puntos de recogida de equipaje, puertas de embarque o puestos de información.
\end{itemize}

\begin{figure}[H]
	\centering
	\includegraphics[width=\columnwidth]{orlandoAirport}
	\caption{La aplicación del Aeropuerto Internacional de Orlando}
	\label{fig:orlandoAirport}
\end{figure}

El siguiente punto sería ampliar la opción a los establecimientos de ofrecer anuncios o promociones, opción que mantienen abierta y no se descarta en un futuro.

%Articulos sacados de: \cite{URL::Ariculo} http://www.securedgenetworks.com/blog/3-brilliant-examples-of-how-beacon-technology-is-transforming-mobility


\section{CouchBase Server}

Couchbase Server es una base de datos NoSQL con una arquitectura distribuida orientada al rendimiento, escalabilidad y disponibilidad. Da la oportunidad a los desarrolladores a construir aplicaciones de manera sencialla y más rápida combinando la flexibilidad del JSON y la tecnología NoSQL.

\subsection{¿Por qué utilizar Couchbase Server?}

Hemos decidido utilizar esta tecnología por su flexibilidad y potencia para almacenar documentos fácilmente. Además es muy sencillo integrarla con la tecnología móvil mediante el uso de una base de datos reducida dentro del dispositivo móvil y sincronizándola con la base de datos principal del servidor mediante una puerta de sincronización.

\begin{figure}[H]
	\centering
	\includegraphics[width=\columnwidth]{couchbaseexplanation}
	\caption{Sincronización de CouchBase Server con CouchBase Lite mediante Sync Gateway}
	\label{fig:couchbaseexplanation}
\end{figure}

En este caso se ha configurado el servidor en un ordenador portátil haciendo uso de las indicaciones de la página web del producto. Se procederá a desglosar brevemente los pasos seguidos a la hora de configurar el servidor.


\subsection{Configuración de la arquitectura}

Para configurar el servidor se han seguido los siguientes pasos: 


\begin{itemize}
\item Descargar la versión Community del producto desde la página web siguiendo el enlace: http://www.couchbase.com/nosql-databases/downloads . 
\item Seguir los pasos de la página de desarrolladores para la intallación y configuración: http://developer.couchbase.com/documentation/server/4.5/getting-started/installing.html y 
%http://developer.couchbase.com/documentation/server/4.5/install/init-setup.html#topic12527 . 
\item Una vez configurado CouchBase Server procedemos a descargar Sync Gateway que será el servicio que se encarge de sincronizar el contenido del nuestra aplicación al servidor, para ello lo descargaremos de la página al igual que el servidor siguiendo el link: http://www.couchbase.com/nosql-databases/downloads .
\item Para vincular el servidor con Sync Gateway es necesario hacer uso de un fichero de configuración con el que lanzaremos el servicio Sync Gateway.
\item Una vez configurado Sync Gateway, ya tenemos el canal de configuración entre el servidor y la aplicación, para utilizar la base de datos móvil seguiremos los pasos desglosados en: http://developer.couchbase.com/documentation/mobile/1.2/develop/training/build-first-android-app/index.html .
\end{itemize}


En este caso, se ha tenido que conectar el dispositivo al ordenador, tanto el ordenador como el dispositivo móvil han de estar en la misma red y hemos utilizado la dirección IP de la máquina para realizar las peticiones del móvil al servidor (alojado en el portátil) al utilizar la API. De esta manera se ha comprobado el funcionamiento del servidor, del servicio de sincronización y de la base de datos versión lite en el dispositivo móvil.


\section{La librería AltBeacon}


\subsection{¿Qué es AltBeacon?}

Se puede definir AltBeacon como una especificación que: 

\begin{itemize}
\item Define el formato del mensaje publicitario que los beacons transmiten a través de BLE (Bluetooth Low Energy).
\item Intenta crear un mercado abierto y competitivo para implementaciones usando proximidad con los beacons.
\item Puede ser utilizada por todos gratuitamente, sin cuotas ni compromisos.
\item No favorece a ningún proveedor sobre otro. Las limitaciones vienen determinadas por los estándares técnicos del proveedor.
\end{itemize}

A continuación se profundizará en el funcionamiento y configuración de la librería AltBeacon, librería que cumple con la especificación AltBeacon y que se ha utilizado para trabajar en Android.

\subsection{Configuración}

Para trabajar con esta librería en Android Studio solo hemos tenido que importarla mediante el uso de Gradle a nuestro proyecto como se explica en : 

https://altbeacon.github.io/android-beacon-library/configure.html

También es posible descargarla desde la página oficial, donde además podremos econtrar diferentes versiones de la misma, para ello podemos hacer uso del siguiente enlace y seleccionar la versión deseada: 

https://altbeacon.github.io/android-beacon-library/download.html

\subsection{Funcionamiento}

Prácticamente la funcionalidad de esta librería se centra en dos elementos principales: 

\begin{itemize}
\item \textit{''Monitoring''} que sería algo así como supervisar, saber que beacons se encuentran en una región o si ha entrado o salido un beacon de una región.
\item \textit{''Ranging''} que hace referencia a rastrear, permitiendo saber a que distancia se encuentran los beacons en todo momento dentro de una región.
\end{itemize}

Utilizando estas dos funcionalidades la aplicación es capaz de controlar, monitoreando y rastreando los distintos beacons en una determinada región. En la página web de la libraría se pueden encontrar ejemplos básicos de como se realizan estas dos funciones en la sección \textit{''Samples''}, además en la sección \textit{''Documentación''} se pueden encontrar también algunos artículos, que pueden resultar interesantes dependiendo del tipo de aplicación que estes desarrollando.




